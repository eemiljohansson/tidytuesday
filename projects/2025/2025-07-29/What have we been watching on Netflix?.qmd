---
title: "What have we been watching on Netflix?"
format: html
---

# Load packages

```{r}
library(tidyverse)
library(ggrepel)
library(scales)
```

# Load data

```{r}
movies <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-29/movies.csv')
shows <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-29/shows.csv')
```

# Plots

```{r}
movies <- movies |>
  mutate(
      hrs  = str_extract(runtime, "(?<=\\b)\\d+(?=H)") %>% as.numeric(),
      mins = str_extract(runtime, "(?<=\\b)\\d+(?=M)") %>% as.numeric(),
      length = coalesce(hrs, 0) * 60 + coalesce(mins, 0)
    ) %>% 
    select(-hrs, -mins)

movies |> head(n = 10)
```

```{r}
# Netflix palette
netflix_black <- "#141414"
netflix_red   <- "#E50914"
netflix_grey  <- "#444444"

movies %>% 
  filter(length < 4*60) %>%
  mutate(
    label = if_else(
      views > 10e6 | length > 3*60,   
      title,
      NA_character_
    )
  ) %>%
  ggplot(aes(x = length/60, y = views/1e6)) +
  
  # points
  geom_point(
    aes(size = hours_viewed, fill = available_globally),
    shape  = 21,
    color  = netflix_grey,
    stroke = 0.3,
    alpha  = 0.8
  ) +
  
  # labels
  geom_text_repel(
    aes(label = label),
    color        = "white",
    na.rm        = TRUE,
    max.overlaps = 10,
    size         = 3
  ) +
  
  # scales
  scale_size_continuous(name = "Hours Viewed", range = c(1, 6)) +
  scale_fill_manual(
    name   = "Available Globally",
    values = c("Yes" = netflix_red, "No"  = netflix_grey)
  ) +
  scale_x_continuous(
    labels = label_number(suffix = "h"),
    expand = expansion(add = 0.1)
  ) +
  scale_y_continuous(
    labels = label_number(suffix = "M"),
    expand = expansion(add = 1)
  ) +
  
  # labels
  labs(
    title    = "Netflix: Movie Length vs. Views",
    subtitle = "Dot size = total hours viewed",
    x        = "Length (hours)",
    y        = "Views (million)",
    caption  = "Data: Netflix viewing, Jan 2023 – Jun 2025"
  ) +
  
  # Netflix‐style dark theme
  theme_minimal(base_size = 12) +
  theme(
    text             = element_text(color = "white"),
    plot.title       = element_text(face = "bold", size = 20, color = netflix_red),
    plot.subtitle    = element_text(size = 12, color = alpha("white", 0.8)),
    plot.caption     = element_text(size = 8, color = alpha("white", 0.5)),
    axis.title       = element_text(color = "white"),
    axis.text        = element_text(color = alpha("white", 0.8)),
    panel.background = element_rect(fill = netflix_black, color = NA),
    plot.background  = element_rect(fill = netflix_black, color = NA),
    panel.grid.major = element_line(color = "#333333", size = 0.3),
    panel.grid.minor = element_blank(),
    legend.background= element_rect(fill = netflix_black, color = NA),
    legend.key       = element_rect(fill = netflix_black),
    legend.text      = element_text(color = "white"),
    legend.title     = element_text(color = "white")
  )


ggsave("../2025-07-29/scatter_plot_netflix_movie_length.png", width = 18, height = 12)
ggsave("../2025-07-29/scatter_plot_netflix_movie_length.pdf", width = 18, height = 12, dpi = 300)
```


# SessionInfo

```{r}
sessionInfo()
```

End of file.
